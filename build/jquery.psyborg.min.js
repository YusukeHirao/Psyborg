/**
 * Psyborg.js - v0.4.2 r816
 * update: 2013-12-21
 * Author: Yusuke Hirao [http://www.yusukehirao.com]
 * Github: https://github.com/YusukeHirao/Psyborg
 * License: Licensed under the MIT License
 * Require: jQuery v1.10.x
 */

!function(){"use strict";var a=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},b=function(){function a(a){this.defaultPrevented=!1,this.type=a,this.timeStamp=(new Date).valueOf()}return a.prototype.preventDefault=function(){this.defaultPrevented=!0},a}(),c=function(){function a(){this._listeners={}}return a.prototype.on=function(a,b){for(var c=a.split(/\s+/),d=0,e=c.length;e>d;d++)this._listeners[c[d]]||(this._listeners[c[d]]=[]),this._listeners[c[d]].push(b)},a.prototype.off=function(a,b){for(var c,d=a.split(/\s+/),e=0,f=d.length;f>e;e++)c=d[e],(null==b||this._listeners[c]===b)&&delete this._listeners[c]},a.prototype.trigger=function(a,c,d){"undefined"==typeof c&&(c={}),"undefined"==typeof d&&(d=this);var e,f,g=0;if(this._listeners[a])for(f=this._listeners[a].length;f>g;g++){e=this._listeners[a][g];var h=new b(a);if(h.data=c,e.call(d,h),h.defaultPrevented)return!1}return!0},a}(),d=function(){function a(){}return a.posAbs=function(a,b,c){return"undefined"==typeof b&&(b=0),"undefined"==typeof c&&(c=0),a.css({position:"absolute",top:b,left:c})},a.posBase=function(a){var b=a.css("position");return(null==b||"static"===b||""===b)&&a.css({position:"relative"}),a},a.z=function(a,b){return"undefined"==typeof b&&(b=0),a.css({zIndex:b}),a},a.isOverflowHidden=function(a){return"hidden"===a.css("overflow").toLowerCase()},a.saveCSS=function(a){a.each(function(a,b){var c=$(b);c.data("originStyle",c.attr("style"))})},a.restoreCSS=function(a){a.each(function(a,b){var c=$(b);c.attr("style",c.data("originStyle"))})},a}(),e=function(){function a(){}return a.getSpeed=function(a,b){return a/b},a.getDuration=function(a,b){return a/b},a.getDistance=function(a,b){return a*b},a}(),f=function(b){function c(a){if(b.call(this),!a.length)throw new ReferenceError('This jQuery object is empty. Selector "'+a.selector+"\" doesn't exist.");this.$el=a}return a(c,b),c.prototype.trigger=function(a,c,d){"undefined"==typeof c&&(c={}),"undefined"==typeof d&&(d=this);var e=b.prototype.trigger.call(this,a,c,d);return e&&this.$el.trigger(a,c,d),e},c}(c),g=function(){function a(){}return a.NONE="none",a.RETURN="return",a.LOOP="loop",a}(),h=function(){function a(){}return a.INIT="init",a.PANEL_CHANGE_START="panelChangeStart",a.PANEL_CHANGE_END="panelChangeEnd",a.PANEL_CHANGE_CANCEL="panelChangeCancel",a.WAIT_START="waitStart",a.WAIT_END="waitEnd",a}(),i=function(){function a(){}return a.INIT="init",a.TRANSITION_END="transitionEnd",a.RESIZE="resize",a.RESIZE_START="resizeStart",a.RESIZE_END="resizeEnd",a.REFLOW_METHOD="reflowMethod",a}(),j=function(b){function c(a,c,d){b.call(this,a),this.index=c,this._list=d}return a(c,b),c.prototype.show=function(){return this.$el.show(),this},c.prototype.hide=function(){return this.$el.hide(),this},c.prototype.clone=function(){var a=new k(this.$el.clone(),this.index,this._list);return this.$el.after(a.$el),this._list.addClone(a),a},c}(f),k=function(b){function c(a,c,d){b.call(this,a,c,d)}return a(c,b),c}(j),l=function(b){function c(a){b.call(this,a),this._panels=[],this._$panels=$(),this._clones=[],this.length=0;for(var c,d=0,e=a.length;e>d;d++)c=$(a[d]),this.add(c)}return a(c,b),c.prototype.setCurrent=function(a,b){return this.resetCurrent(b),this.item(a).$el.addClass(b),this},c.prototype.resetCurrent=function(a){return this.$el.removeClass(a),this},c.prototype.add=function(a){var b=this._panels.length,c=new j(a,b,this);return this._panels.push(c),this.$el=this.$el.add(a),this.length+=1,this},c.prototype.addClone=function(a){return this._clones.push(a),this},c.prototype.remove=function(a,b){return"undefined"==typeof b&&(b=!0),b&&this.$el.eq(a).remove(),this._panels.splice(a,1),this._renumbering(),this.length-=1,this},c.prototype.item=function(a){var b=this._getRealIndex(a);return this._panels[b]},c.prototype.each=function(a){for(var b,c=0,d=this._panels.length;d>c;c++)b=this._panels[c],a.call(b,b.index,b);return this},c.prototype.show=function(){return this.$el.show(),this},c.prototype.hide=function(){return this.$el.hide(),this},c.prototype.removeClone=function(){for(var a=0,b=this._clones.length;b>a;a++)this._clones[a].$el.remove();return this._clones=[],this},c.prototype._getRealIndex=function(a){var b=this._panels.length;a%=b;var c=0>a?b+a:a;return c},c.prototype._renumbering=function(){for(var a=0,b=this._panels.length;b>a;a++)this._panels[a].index=a;return b},c}(f),m=function(b){function c(){b.apply(this,arguments)}return a(c,b),c}(f),n=function(b){function c(){b.apply(this,arguments)}return a(c,b),c}(f),o=function(){function a(a,b){this.name=a,$.extend(this,b)}return a.create=function(b){var c,d;for(c in b)d=new a(c,b[c]),a.transitions[c]=d},a.transitions={},a}();o.create({slide:{init:function(){var a=this;d.posBase(this.stage.$el),d.posAbs(this.container.$el),d.posAbs(this.panels.$el);var b=this.panels.$el;d.saveCSS(b);var c,f,g,h,i,j=!1,k=!1;this._config.draggable&&(g=this.stage.$el.hammer({drag_block_horizontal:!0,tap_always:!1,swipe_velocity:.1}),g.find("a, img").hammer({drag_block_horizontal:!0,tap_always:!1}),g.on("tap dragstart drag dragend",function(b){switch(b.type){case"tap":!function(){j=!1}();break;case"dragstart":!function(){c=a.container.$el.position().left,i=a.index}();break;case"drag":!function(){var d=b.gesture.deltaX,e=c+d;a.freeze(),j=!0,a.container.$el.css({left:e})}();break;case"dragend":!function(){var d=b.gesture.deltaX,f=a.panelWidth,g=c+d,i=a.panelWidth%h,l=e.getSpeed(a.panelWidth,a._duration),m=2,n=a.index-Math.round(g*m/f);k||(a.setIndex(n,!0,!0),a._before(),a._transitionTo(n,e.getDuration(i,l))),k=!1,j=!1,a.isTransition=!1}()}}),this._config.swipeable&&(g=this.stage.$el.hammer({drag_block_vertical:this._config.dragBlockVertical}),g.on("dragstart",function(a){f=a.timeStamp}),g.on("swipeleft",function(b){var c=b.timeStamp-f;a.isLast()||(k=!0,a.stop(),a.next(c))}),g.on("swiperight",function(b){var c=b.timeStamp-f;a.isFirst()||(k=!0,a.stop(),a.prev(c))})))},reflow:function(a){var b=this;switch(a.timing){case i.TRANSITION_END:case i.RESIZE_START:case i.RESIZE_END:!function(){b.container.$el.css({left:0}),b.panels.hide();var a=b.panels.$el;d.restoreCSS(a),b.panelWidth=a.outerWidth(!0),a.width(b.panelWidth),b.stageWidth=b.stage.$el.width();var c=0,e=b.length;b.panels.removeClone();for(var f,h,i,j,k=b._config.clone;e>c;c++)if(f=b.panels.item(c+b.index),f.show(),b.repeat===g.LOOP)for(f.$el.css({left:b.panelWidth*c}),j=1;k>j;j++)h=f.clone(),h.show(),h.$el.css({left:b.panelWidth*(c-b.length*j)}),i=f.clone(),i.show(),i.$el.css({left:b.panelWidth*(c+b.length*j)});else b.index<=f.index?f.$el.css({left:b.panelWidth*c}):f.$el.css({left:b.panelWidth*(c-b.length)})}()}},silent:function(){},before:function(){},fire:function(){var a,b=this._duration||this._config.duration;this.animation&&this.animation.stop(),a=-1*this.panelWidth*this.vector,this.animation=$.Animation(this.container.$el[0],{left:a},{duration:b,easing:this._config.easing})},cancel:function(){},after:function(){}}}),o.create({fade:{init:function(){d.posBase(this.container.$el),d.posAbs(this.panels.$el)},reflow:function(a){switch(a.timing){case i.TRANSITION_END:case i.RESIZE_START:case i.RESIZE_END:this.stage.$el.height(this.panels.$el.height()),d.z(this.panels.$el,0),d.z(this.panels.item(this.to).$el,10)}},silent:function(){},before:function(){this.panels.item(this.to).$el.css({opacity:0}),d.z(this.panels.item(this.to).$el,20)},fire:function(){this.animation&&this.animation.stop(),this.animation=$.Animation(this.panels.item(this.to).$el[0],{opacity:1},{duration:this._config.duration})},cancel:function(){},after:function(){}}});var p=function(b){function c(a,c){b.call(this,a),this.index=0,this.vector=0,this.isTransition=!1,this.isPaused=!1;var d={instanceKey:"psycle",startIndex:0,transition:"slide",duration:600,easing:"swing",delay:3e3,auto:!0,cancel:!0,repeat:g.RETURN,container:">ul:eq(0)",panels:">li",currentClass:"current",delayWhenFire:0,clone:2,cols:1,rows:1,offsetX:0,offsetY:0,nearby:!1,innerFocus:!1,noFocus:!0,resizable:!1,draggable:!1,swipeable:!1,dragBlockVertical:!1,bindKeyboard:!1,showOnlyOnce:null,controller:null,marker:null,thumbnail:null,css3:!0,loopCloneLength:null,scenes:[]};this._config=$.extend(d,c);var e=a,f=e.find(this._config.container),h=f.find(this._config.panels);if(this.stage=new n(e),this.container=new m(f),this.panels=new l(h),this.transition=o.transitions[this._config.transition],null==this.transition)throw new ReferenceError("'"+this._config.transition+"' is not transition type");if((this._config.draggable||this._config.swipeable)&&!jQuery.fn.hammer&&!Hammer)throw new ReferenceError('"Hammer.js" is required when use "draggable" or "swipeable" options.');this.index=this._config.startIndex,this.to=this._config.startIndex,this.from=this._config.startIndex,this.repeat=this._config.repeat,this.length=this.panels.length,this.progressIndex=this.index,this._resizeable(),this._init(),this._silent(),this._config.auto&&this.play(),a.data(this._config.instanceKey,this)}return a(c,b),c.prototype.play=function(){var a=this,b=this.trigger("play");return b&&(this.timer=setTimeout(function(){a.next()},this._config.delay)),this},c.prototype.stop=function(){return clearTimeout(this.timer),this.isPaused=!0,this},c.prototype.freeze=function(){return this.animation&&this.animation.stop(),this},c.prototype.gotoPanel=function(a,b){var c=this;return this.isTransition||!this.setIndex(a,!1)?this:(this._before(),setTimeout(function(){c._transitionTo(a,b)},this._config.delayWhenFire),this)},c.prototype.setIndex=function(a,b,c){"undefined"==typeof b&&(b=!0),"undefined"==typeof c&&(c=!1);var d=this._optimizeCounter(a);return c||d!==this.index?(this.vector=this._optimizeVector(d),this.stop(),this.from=this.index,this.to=d,this.progressIndex=a,b&&(this.index=d),!0):!1},c.prototype.prev=function(a){return this.isTransition?this:(this.gotoPanel(this.index-1,a),this)},c.prototype.next=function(a){return this.isTransition?this:(this.gotoPanel(this.index+1,a),this)},c.prototype.reflow=function(a){return this.transition.reflow.call(this,{timing:i.REFLOW_METHOD,data:a}),this},c.prototype.isFirst=function(){return this._isFirst(this.index)},c.prototype.isLast=function(){return this._isLast(this.index)},c.prototype.marker=function(){for(var a,b=this,b=this,c=$("<ul />"),d=0,e=this.length;e>d;d++)a=$("<li />"),a.appendTo(c);var f=c.find("li");return this.on(h.PANEL_CHANGE_END,function(a){f.removeClass(b._config.currentClass),f.eq(a.data.index).addClass(b._config.currentClass)}),f.eq(this._config.startIndex).addClass(this._config.currentClass),f.on("click",function(){b.gotoPanel($(this).index())}),c},c.prototype._transitionTo=function(a,b){var c=this;return this.isTransition=!0,this._duration=b,this._fire(),this.animation.done(function(){c._done()}),this.animation.fail(function(){c._fail()}),this},c.prototype._optimizeVector=function(a){var b,c=Math.abs(this.index-a);if(this.repeat===g.LOOP){var d=a-this.length,e=a+this.length,f=Math.abs(this.index-d),h=Math.abs(this.index-e),i={};i[f]=-1,i[h]=1,i[c]=this.index<a?1:-1;var j=Math.min(c,h,f);b=i[j]*j}else b=c*(this.index<a?1:-1);return b},c.prototype._optimizeCounter=function(a){var b,c=this.length-1;switch(this.repeat){case g.LOOP:case g.RETURN:b=0>a?c+a%c+1:a,b=c>b?b:b%(c+1);break;default:b=0>a?0:a,b=c>b?b:c,(this._isFirst(b)||this._isLast(b))&&this.stop()}return b},c.prototype._isFirst=function(a){return 0===a},c.prototype._isLast=function(a){return a===this.length-1},c.prototype._resizeable=function(){var a,b=this,c=300,d=!1;$(window).on("resize",function(){d||(d=!0,b._resizeStart()),clearTimeout(a),b._resize(),a=setTimeout(function(){b._resizeEnd(),d=!1},c)})},c.prototype._getState=function(){return{index:this.index,stage:this.stage,container:this.container,panels:this.panels,stageWidth:this.stageWidth,panelWidth:this.panelWidth,length:this.length,from:this.from,to:this.to,vector:this.vector,isTransition:this.isTransition,isPaused:this.isPaused}},c.prototype._init=function(){this.transition.init.call(this),this.transition.reflow.call(this,{timing:i.INIT}),this.trigger(h.INIT,this._getState())},c.prototype._silent=function(){this.transition.silent.call(this),this.transition.reflow.call(this,{timing:i.TRANSITION_END}),this.panels.setCurrent(this.index,this._config.currentClass)},c.prototype._before=function(){this.transition.before.call(this),this.panels.resetCurrent(this._config.currentClass),this.trigger(h.PANEL_CHANGE_START,this._getState())},c.prototype._fire=function(){this.transition.fire.call(this)},c.prototype._cancel=function(){this.transition.cancel.call(this)},c.prototype._done=function(){this.index=this.to,this.isTransition=!1,this._after(),this._silent(),this.trigger(h.PANEL_CHANGE_END,this._getState()),this._config.auto&&this.play()},c.prototype._after=function(){this.transition.after.call(this)},c.prototype._fail=function(){this.stop(),this._cancel(),this.isTransition=!1,this.trigger(h.PANEL_CHANGE_CANCEL,this._getState())},c.prototype._resize=function(){this.transition.reflow.call(this,{timing:i.RESIZE})},c.prototype._resizeStart=function(){this.transition.reflow.call(this,{timing:i.RESIZE_START}),this.animation&&this.isTransition&&this.freeze()},c.prototype._resizeEnd=function(){this.transition.reflow.call(this,{timing:i.RESIZE_END}),this.isPaused&&this._config.auto&&this.gotoPanel(this.to)},c}(f);jQuery.fn.psycle=function(a){return 0===this.length&&console&&console.warn&&console.warn("This jQuery object is empty."),this.each(function(){new p($(this),a)})},jQuery.fn.cycle||(jQuery.fn.pc=jQuery.fn.psycle)}.call(this);